# 화록

> AI 기반 디지털 창작자 히스토리 및 기여도 분석 플랫폼  

---

## 📌 개요

**화록**은 생성형 AI를 활용한 이미지 창작 과정에서  
인간 창작자의 **프롬프트 작성, 수정, 후처리 개입 과정**을  
기술적으로 기록·분석하여 **실질적인 기여도와 창의성**을 증명하는 플랫폼입니다.

---

## 🎯 프로젝트 목표

- AI 생성 이미지에 대한 **인간 창작자의 개입 요소 추적**
- 프롬프트·이미지·후처리 작업의 **히스토리 자동 기록**
- 창작자의 **기여도 및 창의성 정량 평가**
- 저작권·창작 증명에 활용 가능한 **기술적 근거 데이터 제공**

---

## 🏗️ 아키텍처
<img width="682" height="293" alt="image" src="https://github.com/user-attachments/assets/6484a27f-029f-4428-ad8f-d1f955bb893b" />

---
## 🎥 시연 영상

[![화록 시연 영상](https://img.youtube.com/vi/HIYSgbBQLHU/0.jpg)](https://www.youtube.com/watch?v=HIYSgbBQLHU)


--- 
## 📂 패키지 구조
```text
src/main/java/_v3r/project
├── category        # 프롬프트 / 이미지 카테고리 관리
├── common          # 공통 응답, 예외 처리, 유틸
├── flask/service   # Flask(SAM) 서버 연동
├── history         # 창작 히스토리 관리
├── imageflow       # 이미지 생성 및 처리 흐름
├── prompt          # 프롬프트 생성 및 분석
├── report          # 창의성·기여도 분석 리포트
├── user            # 사용자 관리
└── ProjectApplication.java
```
---

## ⚙️ 백엔드 설계 & 최적화 포인트

### 1️⃣ 트랜잭션 분리 설계
- 이미지 생성, 히스토리 저장, 외부 API 호출을 단일 트랜잭션으로 묶지 않음
- 실패 가능성이 높은 외부 API 호출은 트랜잭션 외부에서 처리
- 데이터 정합성과 서비스 안정성 확보

---

### 2️⃣ S3 업로드 최적화
- Base64 이미지 → Multipart 변환 후 S3 업로드
- 서버 메모리 점유 최소화를 위해 스트림 기반 처리
- 이미지 경로 규칙화 (`userId/chatId/uuid`)로 관리 비용 감소

---

### 3️⃣ Flask(SAM) 서버 비동기 연동
- 이미지 분할 요청은 동기 대기 방식 대신 비동기 요청 구조 채택
- Flask 서버 장애 시 백엔드 서비스 영향 최소화
- 분할 결과를 UUID 기반으로 매핑하여 데이터 정합성 유지

---

### 4️⃣ 히스토리 중심 도메인 설계
- 결과 이미지가 아닌 **‘과정 단위’ 히스토리 저장 구조**
- 프롬프트 → 이미지 → 객체(UUID) → 후처리 로그의 계층적 관계 설계
- 창작 기여도 분석을 위한 확장성 확보

---

### 5️⃣ 읽기 성능 개선
- 히스토리 조회 API에 조회 전용 쿼리 사용
- N+1 문제 방지를 위한 Fetch 전략 조정
- 필요 데이터만 반환하는 Response DTO 분리

---

### 6️⃣ 채팅·후처리 히스토리 조회 캐시 적용
- 채팅 및 히스토리 조회 API는 생성 빈도에 비해 조회 빈도가 높은 특성을 가짐
- 후처리 내역을 포함한 채팅 상세 조회 시 DB 반복 조회를 방지하기 위해 캐시 적용
- Ehcache 기반 `@Cacheable`을 활용하여 읽기 성능 개선
- TTL 기반 만료 전략으로 데이터 최신성 유지
- 조회 중심 API의 응답 속도 및 서버 안정성 향상





